<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Balls in Grid</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        canvas {
            border: 2px solid black;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        #counter {
            font-size: 20px;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>
    <div>
        <button id="addBall">Add Ball</button>
        <button id="removeBall">Remove Ball</button>
        <button id="increaseSpeed">Increase Speed</button>
        <button id="decreaseSpeed">Decrease Speed</button>
        <button id="increaseSize">Increase Size</button>
        <button id="decreaseSize">Decrease Size</button>
        <button id="restart">Restart</button>
        <button id="reset">Reset</button> 
    </div>
    <div id="counter">
        <span id="leftCount">Left: 0</span> | <span id="rightCount">Right: 0</span>
    </div>

    <script>

        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");


        canvas.width = 500;
        canvas.height = 500;


        const defaultRadius = 15;
        const defaultSpeed = 3;
        

        const balls = [];
        let isRunning = true;  

 
        function createBall() {
            const ball = {
                x: Math.random() * (canvas.width - 30) + 15, 
                y: Math.random() * (canvas.height - 30) + 15,
                radius: defaultRadius,  
                dx: (Math.random() * defaultSpeed) + 2, 
                dy: (Math.random() * defaultSpeed) + 2, 
                color: `hsl(${Math.random() * 360}, 100%, 50%)` 
            };
            balls.push(ball);
            updateCounter(); 
        }


        function drawBall(ball) {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
            ctx.closePath();
        }


        function drawGrid() {
            const gridSize = 50;
            ctx.strokeStyle = "#ccc";
            ctx.lineWidth = 0.5;

            for (let x = 0; x < canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
                ctx.closePath();
            }


            for (let y = 0; y < canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
                ctx.closePath();
            }
        }

 
        function updateBallPositions() {
            balls.forEach((ball, index) => {
                if (!isRunning) return;  

 
                ball.x += ball.dx;
                ball.y += ball.dy;

             
                if (ball.x - ball.radius < 0) {
                    ball.x = ball.radius; 
                    ball.dx = -ball.dx;    
                } else if (ball.x + ball.radius > canvas.width) {
                    ball.x = canvas.width - ball.radius; 
                    ball.dx = -ball.dx;   
                }

                if (ball.y - ball.radius < 0) {
                    ball.y = ball.radius;  
                    ball.dy = -ball.dy;    
                } else if (ball.y + ball.radius > canvas.height) {
                    ball.y = canvas.height - ball.radius; 
                    ball.dy = -ball.dy;   
                }

                for (let j = index + 1; j < balls.length; j++) {
                    const otherBall = balls[j];
                    const dx = ball.x - otherBall.x;
                    const dy = ball.y - otherBall.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < ball.radius + otherBall.radius) {

                        const angle = Math.atan2(dy, dx);
                        const sine = Math.sin(angle);
                        const cosine = Math.cos(angle);

                        const x1 = 0;
                        const y1 = 0;
                        const x2 = dx * cosine + dy * sine;
                        const y2 = dy * cosine - dx * sine;

                        const vx1 = ball.dx * cosine + ball.dy * sine;
                        const vy1 = ball.dy * cosine - ball.dx * sine;
                        const vx2 = otherBall.dx * cosine + otherBall.dy * sine;
                        const vy2 = otherBall.dy * cosine - otherBall.dx * sine;

                        const finalVx1 = ((ball.radius - otherBall.radius) * vx1 + (otherBall.radius + otherBall.radius) * vx2) / (ball.radius + otherBall.radius);
                        const finalVx2 = ((ball.radius + ball.radius) * vx1 + (otherBall.radius - ball.radius) * vx2) / (ball.radius + otherBall.radius);
                        
                        ball.dx = finalVx1 * cosine - vy1 * sine;
                        ball.dy = vy1 * cosine + finalVx1 * sine;
                        otherBall.dx = finalVx2 * cosine - vy2 * sine;
                        otherBall.dy = vy2 * cosine + finalVx2 * sine;
                        const overlap = (ball.radius + otherBall.radius) - distance;
                        ball.x += Math.cos(angle) * overlap / 2;
                        ball.y += Math.sin(angle) * overlap / 2;
                        otherBall.x -= Math.cos(angle) * overlap / 2;
                        otherBall.y -= Math.sin(angle) * overlap / 2;
                    }
                }
            });
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawGrid(); 
            balls.forEach(drawBall); 
            updateBallPositions(); 
            updateCounter(); 
            requestAnimationFrame(draw); 
        }
        function updateCounter() {
            let leftCount = 0;
            let rightCount = 0;

            balls.forEach(ball => {
                if (ball.x < canvas.width / 2) {
                    leftCount++;
                } else {
                    rightCount++;
                }
            });
            document.getElementById("leftCount").textContent = `Left: ${leftCount}`;
            document.getElementById("rightCount").textContent = `Right: ${rightCount}`;

            if (leftCount === 0 || rightCount === 0) {
                isRunning = false; 
            }
        }
        document.getElementById('addBall').addEventListener('click', () => {
            createBall();
        });
        document.getElementById('removeBall').addEventListener('click', () => {
            if (balls.length > 0) {
                balls.pop(); 
                updateCounter(); 
            }
        });
        document.getElementById('increaseSpeed').addEventListener('click', () => {
            balls.forEach(ball => {
                ball.dx *= 1.2;  
                ball.dy *= 1.2;
            });
        });
        document.getElementById('decreaseSpeed').addEventListener('click', () => {
            balls.forEach(ball => {
                ball.dx *= 0.8;  
                ball.dy *= 0.8;
            });
        });
        document.getElementById('increaseSize').addEventListener('click', () => {
            balls.forEach(ball => {
                ball.radius *= 1.2; 
            });
        });
        document.getElementById('decreaseSize').addEventListener('click', () => {
            balls.forEach(ball => {
                ball.radius *= 0.8;  
            });
        });
        document.getElementById('restart').addEventListener('click', () => {

            balls.forEach(ball => {
                ball.x = Math.random() * (canvas.width - 2 * ball.radius) + ball.radius;
                ball.y = Math.random() * (canvas.height - 2 * ball.radius) + ball.radius;
            });
            isRunning = true; 
            updateCounter(); 
        });
        document.getElementById('reset').addEventListener('click', () => {

            balls.length = 0;
            createBall(); 
            balls.forEach(ball => {
                ball.radius = defaultRadius;
                ball.dx = defaultSpeed;
                ball.dy = defaultSpeed;
            });

            updateCounter();
        });
        createBall();
        draw();
    </script>

</body>
</html>

